\hypertarget{a00880}{}\doxysubsection{Controller Class Reference}
\label{a00880}\index{Controller@{Controller}}


Collaboration diagram for Controller\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00878}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{a00880_aeee02f1e6f84f42452208c1bf0bb62cf}{Controller}} ()
\item 
String \mbox{\hyperlink{a00880_a452805917381aab1b944c98baab4fc60}{get\+Confirm\+Code}} (@Path\+Variable String mail\+Address)
\item 
void \mbox{\hyperlink{a00880_a39cf17fc91067c9e3029920f8385d6b2}{post\+Subscription}} (String mail\+Address, UUID sensor\+ID, Period report\+Interval)
\item 
void \mbox{\hyperlink{a00880_a51c2783aa1707d58baf42fa40903c80d}{post\+Unsubscribe}} (String mail\+Address, UUID sensor\+ID)
\item 
List$<$ UUID $>$ \mbox{\hyperlink{a00880_abc4126cefcc887bce2488b113a029fcf}{get\+Subscriptions}} (@Path\+Variable String mail\+Address)
\item 
void \mbox{\hyperlink{a00880_a00084448cb000d2fd9dfcf41074c65f4}{get\+Alert}} (UUID sensor\+ID)
\item 
void \mbox{\hyperlink{a00880_a2172b57ab7bb05150203b0bb4d1a5690}{get\+Report}} (String mail\+Address, UUID sensor\+ID)
\end{DoxyCompactItemize}
\doxysubsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{a00880_af3732ad826179cf5e9cb0936d6073967}\label{a00880_af3732ad826179cf5e9cb0936d6073967}} 
\mbox{\hyperlink{a00920}{Mail\+Builder}} {\bfseries mail\+Builder}
\item 
\mbox{\Hypertarget{a00880_adda51bd757e40eece80e2ad1699e12ae}\label{a00880_adda51bd757e40eece80e2ad1699e12ae}} 
\mbox{\hyperlink{a00884}{Mail\+Sender}} {\bfseries mail\+Sender}
\item 
\mbox{\Hypertarget{a00880_afcacd0bbb4bd13fd06f4c724c47d726c}\label{a00880_afcacd0bbb4bd13fd06f4c724c47d726c}} 
\mbox{\hyperlink{a00904}{Subscription\+DAO}} {\bfseries subscription\+DAO}
\item 
\mbox{\Hypertarget{a00880_a0af2571b58153fd0b2e26765a9e6a904}\label{a00880_a0af2571b58153fd0b2e26765a9e6a904}} 
\mbox{\hyperlink{a00896}{Sensor\+DAO}} {\bfseries sensor\+DAO}
\end{DoxyCompactItemize}


\doxysubsubsection{Detailed Description}
The \mbox{\hyperlink{a00880}{Controller}} is a central component to the E-\/\+Mail Notification System managing most tasks as well as providing an API to outside systems. It is the only class to communicate with the classes from the \textquotesingle{}model\textquotesingle{} and \textquotesingle{}view\textquotesingle{} packages. The \mbox{\hyperlink{a00876}{Checker\+Util}} class can call the \mbox{\hyperlink{a00880}{Controller}} to instruct it to send a report about a certain sensor to a subscriber of that sensor, or to instruct it to send an alert about the malfunction of a certain sensor to one or multiple subscribers. The project website may call the \mbox{\hyperlink{a00880}{Controller}} to issue a confirmation mail containing a confirmation code to be sent to a given e-\/mail address. Furthermore, the \mbox{\hyperlink{a00880}{Controller}} allows the website to add, delete or get information about subscriptions. The \mbox{\hyperlink{a00880}{Controller}} class contains an instance of a Mail\+Builder, a \mbox{\hyperlink{a00884}{Mail\+Sender}}, a Subscription\+DAO and a Sensor\+DAO. 

\doxysubsubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{a00880_aeee02f1e6f84f42452208c1bf0bb62cf}\label{a00880_aeee02f1e6f84f42452208c1bf0bb62cf}} 
\index{Controller@{Controller}!Controller@{Controller}}
\index{Controller@{Controller}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{Controller()}{Controller()}}
{\footnotesize\ttfamily \mbox{\hyperlink{a00880}{Controller}} (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Constructs a new \mbox{\hyperlink{a00880}{Controller}} instance. Instantiates the Mail\+Builder, \mbox{\hyperlink{a00884}{Mail\+Sender}}, Subscription\+DAO and Sensor\+DAO. 

\doxysubsubsection{Member Function Documentation}
\mbox{\Hypertarget{a00880_a00084448cb000d2fd9dfcf41074c65f4}\label{a00880_a00084448cb000d2fd9dfcf41074c65f4}} 
\index{Controller@{Controller}!getAlert@{getAlert}}
\index{getAlert@{getAlert}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{getAlert()}{getAlert()}}
{\footnotesize\ttfamily void get\+Alert (\begin{DoxyParamCaption}\item[{UUID}]{sensor\+ID }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

The get\+Alert method is used to send an alert e-\/mail to all subscribers of a given sensor when that sensor malfunctions or fails. The method uses the Sensor\+DAO class to retrieve the subscribers of the given sensor, then builds and sends the mail using the Mail\+Builder and \mbox{\hyperlink{a00884}{Mail\+Sender}} classes. The method is only called by the \mbox{\hyperlink{a00876}{Checker\+Util}} class. 
\begin{DoxyParams}{Parameters}
{\em sensor\+ID} & ID of the sensor malfunctioning. \\
\hline
\end{DoxyParams}


References Subscription\+DAO.\+get\+All\+Subscribers().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=337pt]{a00880_a00084448cb000d2fd9dfcf41074c65f4_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{a00880_a452805917381aab1b944c98baab4fc60}\label{a00880_a452805917381aab1b944c98baab4fc60}} 
\index{Controller@{Controller}!getConfirmCode@{getConfirmCode}}
\index{getConfirmCode@{getConfirmCode}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{getConfirmCode()}{getConfirmCode()}}
{\footnotesize\ttfamily String get\+Confirm\+Code (\begin{DoxyParamCaption}\item[{@Path\+Variable String}]{mail\+Address }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

Sends a confirmation mail to a user. The method first uses the Mail\+Builder class to build the e-\/mail, then the \mbox{\hyperlink{a00884}{Mail\+Sender}} class to send it to its recipient. 
\begin{DoxyParams}{Parameters}
{\em mail\+Address} & e-\/mail address the confirmation mail is sent to. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
String containing the confirmation code sent to the user. 
\end{DoxyReturn}


References Mail\+Builder.\+build\+Confirmation\+Mail(), Confirmation\+Mail.\+get\+Confirm\+Code(), and Mail\+Sender.\+send().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00880_a452805917381aab1b944c98baab4fc60_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{a00880_a2172b57ab7bb05150203b0bb4d1a5690}\label{a00880_a2172b57ab7bb05150203b0bb4d1a5690}} 
\index{Controller@{Controller}!getReport@{getReport}}
\index{getReport@{getReport}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{getReport()}{getReport()}}
{\footnotesize\ttfamily void get\+Report (\begin{DoxyParamCaption}\item[{String}]{mail\+Address,  }\item[{UUID}]{sensor\+ID }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

The get\+Report methos is used to sent report e-\/mails to a subscriber of the given sensor. Reports contain relevant information about the sensor and the data collected. The method uses the Sensor\+DAO class to retrieve the information about the sensor and its data. The e-\/mail is then built and sent using the Mail\+Builder and \mbox{\hyperlink{a00884}{Mail\+Sender}} classes, respectively. The method is only called by the \mbox{\hyperlink{a00876}{Checker\+Util}} class. 
\begin{DoxyParams}{Parameters}
{\em mail\+Address} & e-\/mail address of the subscriber the report is sent to. \\
\hline
{\em sensor\+ID} & ID of the sensor the report is about. \\
\hline
\end{DoxyParams}


References Mail\+Builder.\+build\+Report(), and Mail\+Sender.\+send().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=316pt]{a00880_a2172b57ab7bb05150203b0bb4d1a5690_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{a00880_abc4126cefcc887bce2488b113a029fcf}\label{a00880_abc4126cefcc887bce2488b113a029fcf}} 
\index{Controller@{Controller}!getSubscriptions@{getSubscriptions}}
\index{getSubscriptions@{getSubscriptions}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{getSubscriptions()}{getSubscriptions()}}
{\footnotesize\ttfamily List$<$UUID$>$ get\+Subscriptions (\begin{DoxyParamCaption}\item[{@Path\+Variable String}]{mail\+Address }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

The get\+Subscription method allows the project website to inquire about the sensors a user is subscribed to. 
\begin{DoxyParams}{Parameters}
{\em mail\+Address} & e-\/mail of the subscriber. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
List of the sensors the user is subscribed to. The list contains the UUIDs of those sensors. 
\end{DoxyReturn}


References Subscription\+DAO.\+get\+All\+Sensors().

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{a00880_abc4126cefcc887bce2488b113a029fcf_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{a00880_a39cf17fc91067c9e3029920f8385d6b2}\label{a00880_a39cf17fc91067c9e3029920f8385d6b2}} 
\index{Controller@{Controller}!postSubscription@{postSubscription}}
\index{postSubscription@{postSubscription}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{postSubscription()}{postSubscription()}}
{\footnotesize\ttfamily void post\+Subscription (\begin{DoxyParamCaption}\item[{String}]{mail\+Address,  }\item[{UUID}]{sensor\+ID,  }\item[{Period}]{report\+Interval }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

The post\+Subscription method allows the project website to add a new subscription to the database. A subscription is always between one subscriber and one sensor. To allow regular reports to be sent, it furthermore contains the time period between these reports. Internally a timestamp is saved marking the beginning of the first time interval. 
\begin{DoxyParams}{Parameters}
{\em mail\+Address} & e-\/mail address of the subscriber. \\
\hline
{\em sensor\+ID} & ID of the sensor the user subscribes to. \\
\hline
{\em report\+Interval} & time period between reports. \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{a00880_a51c2783aa1707d58baf42fa40903c80d}\label{a00880_a51c2783aa1707d58baf42fa40903c80d}} 
\index{Controller@{Controller}!postUnsubscribe@{postUnsubscribe}}
\index{postUnsubscribe@{postUnsubscribe}!Controller@{Controller}}
\doxyparagraph{\texorpdfstring{postUnsubscribe()}{postUnsubscribe()}}
{\footnotesize\ttfamily void post\+Unsubscribe (\begin{DoxyParamCaption}\item[{String}]{mail\+Address,  }\item[{UUID}]{sensor\+ID }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}}

The post\+Unsubscribe method allows the project website to delete a subscription from the databse. 
\begin{DoxyParams}{Parameters}
{\em mail\+Address} & e-\/mail of the user unsubscribing. \\
\hline
{\em sensor\+ID} & ID of the sensor the user unsubscribes from. \\
\hline
\end{DoxyParams}
